\documentclass{article} % For LaTeX2e
\usepackage{nips15submit_e,times}
\usepackage{hyperref}
\usepackage{url}
\usepackage{graphicx}
\usepackage[numbers]{natbib}

\usepackage{enumitem}
% For algorithms
\usepackage{algorithm}
\usepackage{algorithmic}

% For syntax trees
\usepackage{qtree}
\usepackage{ulem}

% For multi columns
\usepackage{multicol}

\renewcommand{\#}[1]{\textbf{#1}}

%\newcommand{\shortcite}[1]{\citeauthor{#1}}
\newcommand{\shortcite}[1]{\citeauthor{#1} (\citeyear{#1})}

% For diagrams
\usepackage{tikz}
\usetikzlibrary{matrix,chains,positioning,decorations.pathreplacing,arrows}
%\documentstyle[nips14submit_09,times,art10]{article} % For LaTeX 2.09

\title{Supplemenary Materials for ``Exploring Models and Data for Image Question Answering''}

\author{
Mengye Ren\\
Department of Computer Science\\
University of Toronto\\
%Toronto ON, CANADA M5S 1A1\\
\texttt{mren@cs.toronto.edu} \\
\And
Ryan Kiros\\
Department of Computer Science\\
University of Toronto\\
%Toronto ON, CANADA M5S 1A1\\
\texttt{rkiros@cs.toronto.edu} \\
\And
Richard Zemel\\
Department of Computer Science\\
University of Toronto\\
%Toronto ON, CANADA M5S 1A1\\
\texttt{zemel@cs.toronto.edu} \\
}

\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}

%\nipsfinalcopy % Uncomment for camera-ready version

\begin{document}
\maketitle
\appendix
\section{Supplementary Material}
\subsection{Question Generation: Syntax Tree Example}
\begin{figure}[h!]
    \centering
    \small
    \scalebox{0.8}{
    \Tree [.S [.NP [.DET a ] [.N man ] ] [.VP [.V is ] [.NP [.VBG riding ] [.NP [.DET a ] [.N horse ] ] ] ] ]}
    \scalebox{0.8}{
    \Tree [.S [.WHNP [.WP \textbf{what} ] ] [.S [.V is ] [.NP [.DET \textbf{the} ] [.N man ] ] [.VP [.V \sout{is} ] [.NP [.VBG riding ] [.WHNP [.WP \sout{what} ] ] ] ] ] ]}
    \vspace{5mm}
    \caption{Example: ``A man is riding a \textbf{horse}'' $=>$ ``\textbf{What} is \textbf{the} man riding?''}
    \label{fig:what_gen}
\end{figure}

\subsection{Post-Processing of COCO-QA Detail}
\label{app:post_process}
First, answers that appear less than a frequency threshold are discarded. 
Second we enroll a QA pair one at a time. 
The probability of enrolling the next QA pair $(q, a)$ is:
\begin{equation}
p(q, a) = \left\{ \begin{array}{cl}
1 &\mbox{ if count$(a)$ $\le K$ } \\
\exp\left(-\frac{count(a) - K}{[K_2}\right) &\mbox{ otherwise }
\end{array} \right.
\end{equation}
where $count(a)$ denotes the current number of enrolled QA pairs that have $a$
as the ground truth answer, and $K$, $K_2$ are some constants with $K \le
K_2$. In the COCO-QA generation we chose $K = 100$ and $K_2 = 200$. 

\clearpage
\subsection{More Sample Questions and Responses}
\label{sec:more_examples}
\begin{figure}[h]
\centering
\tiny
$\begin{array}{p{3.2cm} p{3.2cm} p{3.2cm} p{3.2cm}}
\scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]
        {24952.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 23419\\
        \textbf{What is the black and white cat wearing?}\\
        Ground truth: hat\\
        IMG+BOW: \textcolor{green}{hat (0.50)}\\
        2-VIS+BLSTM: \textcolor{red}{tie (0.34)}\\
        BOW: \textcolor{red}{tie (0.60)}
        \vskip 0.05in
        COCOQA 23419a\\
        \textbf{What is wearing a hat?}\\
        Ground truth: cat\\
        IMG+BOW: \textcolor{green}{cat (0.94)}\\
        2-VIS+BLSTM: \textcolor{green}{cat (0.90)}\\
        BOW: \textcolor{red}{dog (0.42)}
}
&
\scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{2136.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        DAQUAR 2136\\
        \textbf{What is right of table?}\\
        Ground truth: shelves\\
        IMG+BOW: \textcolor{green}{shelves (0.33)}\\
        2-VIS+BLSTM: \textcolor{green}{shelves (0.28)}\\
        LSTM: \textcolor{green}{shelves (0.20)}

        \vskip 2mm
        DAQUAR 2136a\\
        \textbf{What is in front of table?}\\
        Ground truth: chair\\
        IMG+BOW: \textcolor{green}{chair (0.64)}\\
        2-VIS+BLSTM: \textcolor{green}{chair (0.31)}\\
        LSTM: \textcolor{green}{chair (0.37)}
}
&
\scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{5429.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 11372\\
        \textbf{What do two women hold with a picture on it?}\\
        Ground truth: cake\\
        IMG+BOW: \textcolor{green}{cake (0.19)}\\
        2-VIS+BLSTM: \textcolor{green}{cake (0.19)}\\
        BOW: \textcolor{red}{umbrella (0.15)}
}
&
\scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{3018.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        DAQUAR 3018\\
        \textbf{What is on the right side?}\\
        Ground truth: table\\
        IMG+BOW: \textcolor{red}{tv (0.28)}\\
        2-VIS+LSTM: \textcolor{red}{sofa (0.17)}\\
        LSTM: \textcolor{red}{cabinet (0.22)}
}
\\
\noalign{\smallskip}\noalign{\smallskip}
\scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{1426.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        DAQUAR 1426\\
        \textbf{What is on the right side table?}\\
        Ground truth: tv\\
        IMG+BOW: \textcolor{green}{tv (0.25)}\\
        2-VIS+LSTM: \textcolor{green}{tv (0.29)}\\
        LSTM: \textcolor{green}{tv (0.14)}
        \vskip 0.05in
        DAQUAR 1426a\\
        \textbf{What is on the left side of the room?}\\
        Ground truth: bed\\
        IMG+BOW: \textcolor{red}{door (0.19)}\\
        2-VIS+LSTM: \textcolor{red}{door (0.25)}\\
        LSTM: \textcolor{red}{door (0.13)}
}
&
\scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{15756.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 15756\\
        \textbf{What does the man rid while wearing a black wet suit?}\\
        Ground truth: surfboard\\
        IMG+BOW: \textcolor{red}{jacket (0.35)}\\
        2-VIS+LSTM: \textcolor{green}{surfboard (0.53)}\\
        BOW: \textcolor{red}{tie (0.30)}
}
&
\scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{9715.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 9715\\
        \textbf{What is displayed with the mattress off of it?}\\
        Ground truth: bed\\
        IMG+BOW: \textcolor{red}{bench (0.36)}\\
        2-VIS+LSTM: \textcolor{green}{bed (0.18)}\\
        BOW: \textcolor{red}{airplane (0.08)}
}
&
\scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{25124.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 25124\\
        \textbf{What is sitting in a sink in the rest room?}\\
        Ground truth: cat\\
        IMG+BOW: \textcolor{red}{toilet (0.77)}\\
        2-VIS+LSTM: \textcolor{red}{toilet (0.90)}\\
        BOW: \textcolor{green}{cat (0.83)}
}
\end{array}$
\caption{Sample questions and responses on Object questions}
\label{fig:object_questions}
\end{figure}

\begin{figure}[ht]
\centering
\tiny
$\begin{array}{p{3.2cm} p{3.2cm} p{3.2cm} p{3.2cm}}
    \scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{35.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
          COCOQA 35\\
          \textbf{How many red velvet cup cakes with no frosting on a flowered plate?}\\
          Ground truth: three\\
          IMG+BOW: \textcolor{green}{three (0.43)}\\
          2-VIS+BLSTM: \textcolor{green}{three (0.26)}\\
          BOW: \textcolor{red}{two (0.26)}
}
&
    \scalebox{0.23}{
            \includegraphics[width=\textwidth, height=.7\textwidth]{21446.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
          COCOQA 21446\\
          \textbf{How many different types of carrying cases in various colors?}\\
          Ground truth: four\\
          IMG+BOW: \textcolor{green}{four (0.69)}\\
          2-VIS+BLSTM: \textcolor{green}{four (0.26)}\\
          BOW: \textcolor{red}{three (0.25)}
}
&    \scalebox{0.23}{
            \includegraphics[width=\textwidth, height=.7\textwidth]{25600.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
          COCOQA 25600\\
          \textbf{How many double deckered busses parked near the green truck?}\\
          Ground truth: three\\
          IMG+BOW: \textcolor{red}{two (0.89)}\\
          2-VIS+BLSTM: \textcolor{red}{two (0.44)}\\
          BOW: \textcolor{red}{two (0.64)}
}
&    \scalebox{0.23}{
            \includegraphics[width=\textwidth, height=.7\textwidth]{555.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
          DAQUAR 555\\
          \textbf{How many chairs are there?}\\
          Ground truth: one\\
          IMG+BOW: \textcolor{red}{six (0.20)}\\
          2-VIS+BLSTM: \textcolor{green}{one (0.20)}\\
          LSTM: \textcolor{red}{four (0.19)}
}
\end{array}$

\caption{Sample questions and responses on Number questions}
\label{fig:number_questions}
\end{figure}

\begin{figure}[ht!]
\centering
\tiny
$\begin{array}{p{3.2cm} p{3.2cm} p{3.2cm} p{3.2cm}}
    \scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{298.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 298\\
        \textbf{What is the color of the airplane?}\\
        Ground truth: blue\\
        IMG+BOW: \textcolor{green}{blue (0.48) }\\
        2-VIS+LSTM: \textcolor{green}{blue (0.33) }\\
        BOW: \textcolor{red}{white (0.38)}
}
&
    \scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{2989.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        DAQUAR 2989\\
        \textbf{What is the color of the sofa?}\\
        Ground truth: red\\
        IMG+BOW: \textcolor{green}{red (0.31) }\\
        VIS+LSTM-2: \textcolor{green}{red (0.22) }\\
        LSTM: \textcolor{red}{brown (0.21) }

        \vskip 0.05in
        DAQUAR 2989a\\
        \textbf{What is the color of the table?}\\
        Ground truth: white\\
        IMG+BOW: \textcolor{green}{white (0.29) }\\
        VIS+LSTM-2: \textcolor{green}{white (0.41) }\\
        LSTM: \textcolor{green}{white (0.28) }
}
&
    \scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{22891.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 22891\\
        \textbf{What is the color of the coat?}\\
        Ground truth: yellow\\
        IMG+BOW: \textcolor{red}{black(0.45)}\\
        VIS+LSTM: \textcolor{green}{yellow (0.24)}\\
        BOW:  \textcolor{red}{red (0.28)}
        \vskip 0.05in
        COCOQA 22891a\\
        \textbf{What is the color of the umbrella?}\\
        Ground truth: red\\
        IMG+BOW: \textcolor{red}{black(0.28)}\\
        VIS+LSTM-2: \textcolor{red}{yellow (0.26)}\\
        BOW:  \textcolor{green}{red (0.29) }
}
&
    \scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{20140.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 20140\\
        \textbf{What is the color of the coat?}\\
        Ground truth: orange\\
        IMG+BOW: \textcolor{green}{orange(0.21)}\\
        VIS+LSTM: \textcolor{red}{yellow (0.21)}\\
        BOW:  \textcolor{red}{red (0.18)}
        \vskip 0.05in
        COCOQA 20140a\\
        \textbf{What is the color of the pants?}\\
        Ground truth: black\\
        IMG+BOW: \textcolor{green}{black(0.27)}\\
        VIS+LSTM-2: \textcolor{green}{black (0.23)}\\
        BOW:  \textcolor{green}{black (0.30) }
}
\end{array}$
\caption{Sample questions and responses on Color questions}
\label{fig:color_questions}
\end{figure}

\begin{figure}[ht!]
\centering
\tiny
$\begin{array}{p{3.2cm} p{3.2cm} p{3.2cm} p{3.2cm}}
    \scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{6427.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 6427\\
        \textbf{Where does the young boy secure himself?}\\
        Ground truth: suitcase\\
        IMG+BOW: \textcolor{green}{suitcase (0.39)}\\
        2-VIS+LSTM: \textcolor{red}{car (0.32)}\\
        BOW: \textcolor{red}{mirror (0.23)}
}
&
    \scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{6662.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 6662\\
        \textbf{Where does the small kitten sit?}\\
        Ground truth: bowl\\
        IMG+BOW: \textcolor{green}{bowl (0.55)}\\
        2-VIS+LSTM: \textcolor{green}{bowl (0.40)}\\
        BOW: \textcolor{red}{chair (0.14)}
}
&
    \scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{28542.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 28542\\
        \textbf{Where is the pan of food?}\\
        Ground truth: oven\\
        IMG+BOW: \textcolor{green}{oven (0.67)}\\
        2-VIS+LSTM: \textcolor{green}{oven (0.93)}\\
        BOW: \textcolor{red}{kitchen (0.37)}
}
&
    \scalebox{0.23}{
        \includegraphics[width=\textwidth, height=.7\textwidth]{21112.jpg}}
    \parbox{3.2cm}{
        \vskip 0.05in
        COCOQA 21112\\
        \textbf{Where is the cat observing the dishwasher?}\\
        Ground truth: kitchen\\
        IMG+BOW: \textcolor{red}{sink (0.39)}\\
        2-VIS+LSTM: \textcolor{red}{chair (0.44)}\\
        BOW: \textcolor{red}{sink (0.17)}
}
\end{array}$
\caption{Sample questions and responses on Location questions}
\label{fig:location_questions}
\end{figure}
\end{document}